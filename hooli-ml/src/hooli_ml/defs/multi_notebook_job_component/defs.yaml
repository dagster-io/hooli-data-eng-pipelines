type: hooli_ml.components.DatabricksMultiNotebookJobComponent

attributes:
  job_name_prefix: "feature_engineering_multi_job"
  serverless: true
  # cluster_config:
  #   spark_version: "13.3.x-scala2.12"
  #   node_type_id: "i3.xlarge"
  #   num_workers: 1
  
  tasks:
    - task_key: "pickup_features"
      notebook_path: "/Users/christian@dagsterlabs.com/.bundle/databricks_mlops/dev/files/feature_engineering/notebooks/GenerateAndWriteFeatures"
      asset_key: "feature_engineering_pickup_job"
      kinds: ["databricks", "feature_engineering"]
      parameters:
        model_type: "RandomForest"
        training_data_path: "/databricks-datasets/nyctaxi-with-zipcodes/subsampled"
        timestamp_column: "tpep_pickup_datetime"
        output_table_name: "{{ env }}.databricks_mlops.trip_pickup_features"
        features_transform_module: "pickup_features"
        primary_keys: "zip"
    
    - task_key: "dropoff_features"
      notebook_path: "/Users/christian@dagsterlabs.com/.bundle/databricks_mlops/dev/files/feature_engineering/notebooks/GenerateAndWriteFeatures"
      asset_key: "feature_engineering_dropoff_job"
      kinds: ["databricks", "feature_engineering"]
      parameters:
        model_type: "RandomForest"
        training_data_path: "/databricks-datasets/nyctaxi-with-zipcodes/subsampled"
        timestamp_column: "tpep_dropoff_datetime"
        output_table_name: "{{ env }}.databricks_mlops.trip_dropoff_features"
        features_transform_module: "dropoff_features"
        primary_keys: "zip"
